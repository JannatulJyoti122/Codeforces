#include<bits/stdc++.h>
using namespace std;
using ll=long long int;
int main(){
    int tt;
    cin>>tt;
    while(tt--){
        ll n,k;
        cin>>n>>k;
        string s;
        cin>>s;
        getchar();
        ll a[n];
        ll ct=0;
        for(ll i=0;i<n;i++){
            cin>>a[i];
        }
        ll sub_sum[n];
        ll ss=a[0];
        sub_sum[0]=a[0];
        for(ll i=1;i<n;i++){
            if(ss>0&&ss+a[i]>0&&ss+a[i]>a[i]){
                ss+=a[i];
                sub_sum[i]=ss;
            }
            else{
                sub_sum[i]=a[i];
                ss=a[i];
            }
        }
        ll sub[n];
        ss=a[n-1];
        sub[n-1]=ss;
        for(ll i=n-2;i>=0;i--){
            if(ss>0&&ss+a[i]>0&&ss+a[i]>a[i]){
                ss+=a[i];
                sub[i]=ss;
            }
            else{
                sub[i]=a[i];
                ss=a[i];
            }
        }
        ll ct2=0;
        for(ll i=0;i<n;i++){
            if(s[i]=='0'){
                if(i>0){
                    if(sub_sum[i-1]>0) sub_sum[i]=sub_sum[i-1];
                }
                a[i]=k-sub[i]-sub_sum[i];
                sub_sum[i]+=a[i];
            }
            else{
                if(i>0){
                    if(sub_sum[i-1]>0&&sub_sum[i-1]+a[i]>0){
                        sub_sum[i]=sub_sum[i-1]+a[i];
                    }
                    else sub_sum[i]=a[i];
                }
            }
            if(sub_sum[i]>k){
                ct++;
                break;
            }
            if(sub_sum[i]==k) ct2++;
        }
        if(ct>0||ct2==0){
            cout<<"No\n"; continue;
        }
        cout<<"Yes\n";

        for(int i=0;i<n;i++){
            cout<<a[i]<<" ";
        }
        cout<<endl;

    }
}

